{"version":3,"file":"rete-context-menu-plugin.common.js","sources":["src/presets/classic/factory.ts","src/presets/classic/index.ts","src/presets/index.ts","src/index.ts"],"sourcesContent":["import { NodeEditor } from 'rete'\nimport { BaseAreaPlugin } from 'rete-area-plugin'\n\nimport { Item } from '../../types'\nimport { BSchemes, ItemDefinition } from './types'\n\nexport function createItem<S extends BSchemes>(\n  [label, factory]: ItemDefinition<S>,\n  key: string | number,\n  context: { editor: NodeEditor<S>, area: BaseAreaPlugin<S, any> }\n): Item {\n  const item: Item = {\n    label,\n    key: String(key),\n    handler() {\n      /* noop */\n    }\n  }\n\n  if (typeof factory === 'function') {\n    return {\n      ...item,\n      async handler() {\n        const node = await factory()\n\n        await context.editor.addNode(node)\n\n        void context.area.translate(node.id, context.area.area.pointer)\n      }\n    } satisfies Item\n  }\n  return {\n    ...item,\n    handler() { /* do nothing */ },\n    subitems: factory.map((data, i) => createItem(data, i, context))\n  } satisfies Item\n}\n","import { NodeEditor } from 'rete'\nimport { BaseAreaPlugin } from 'rete-area-plugin'\n\nimport { Item, Items } from '../../types'\nimport { createItem } from './factory'\nimport { BSchemes, ItemDefinition } from './types'\n\n/**\n * Classic context menu preset.\n * Configures nodes/actions items for root and Delete/Clone items for nodes\n * @param nodes List of items\n * @example Presets.classic.setup([\n *  [\"Math\", [\n *    [\"Number\", () => new NumberNode()],\n *  ]]\n *])\n */\nexport function setup<Schemes extends BSchemes>(nodes: ItemDefinition<Schemes>[]) {\n  return function (context, plugin) {\n    const area = plugin.parentScope<BaseAreaPlugin<Schemes, any>>(BaseAreaPlugin)\n    const editor = area.parentScope<NodeEditor<Schemes>>(NodeEditor)\n\n    if (context === 'root') {\n      return {\n        searchBar: true,\n        list: nodes.map((item, i) => createItem(item, i, { editor, area }))\n      }\n    }\n\n    const deleteItem: Item = {\n      label: 'Delete',\n      key: 'delete',\n      async handler() {\n        if ('source' in context && 'target' in context) {\n          // connection\n          const connectionId = context.id\n\n          await editor.removeConnection(connectionId)\n        } else {\n          // node\n          const nodeId = context.id\n          const connections = editor.getConnections().filter(c => {\n            return c.source === nodeId || c.target === nodeId\n          })\n\n          for (const connection of connections) {\n            await editor.removeConnection(connection.id)\n          }\n          await editor.removeNode(nodeId)\n        }\n      }\n    }\n\n    const clone = context.clone?.bind(context)\n    const cloneItem: undefined | Item = clone && {\n      label: 'Clone',\n      key: 'clone',\n      async handler() {\n        const node = clone()\n\n        await editor.addNode(node)\n\n        void area.translate(node.id, area.area.pointer)\n      }\n    }\n\n    return {\n      searchBar: false,\n      list: [\n        deleteItem,\n        ...cloneItem\n          ? [cloneItem]\n          : []\n      ]\n    }\n  } satisfies Items<Schemes>\n}\n","/**\n * Presets that create items for root and node specific context menu.\n * @module\n */\n\nexport * as classic from './classic'\n","import { BaseSchemes, Scope } from 'rete'\nimport { BaseArea, BaseAreaPlugin, RenderSignal } from 'rete-area-plugin'\n\nimport { Item, Items, Position } from './types'\n\nexport * as Presets from './presets'\n\n/**\n * Context menu plugin props\n * @priority 8\n */\nexport type Props<Schemes extends BaseSchemes> = {\n  /**\n   * delay before hiding context menu\n   * @deprecated Use the `delay` option of the rendering plugin preset.\n   */\n  delay?: number\n  /** menu items, can be produced by preset */\n  items: Items<Schemes>\n}\nexport type RenderMeta = { filled?: boolean }\n\n/**\n * Signal types produced by ContextMenuPlugin instance\n * @priority 10\n */\nexport type ContextMenuExtra =\n  | RenderSignal<'contextmenu', {\n    items: Item[]\n    onHide(): void\n    searchBar?: boolean\n  }>\n\ntype Requires<Schemes extends BaseSchemes> =\n  | { type: 'contextmenu', data: { event: MouseEvent, context: 'root' | Schemes['Node'] | Schemes['Connection'] } }\n  | { type: 'unmount', data: { element: HTMLElement } }\n  | { type: 'pointerdown', data: { position: Position, event: PointerEvent } }\n\n/**\n * Plugin for context menu.\n * Responsible for initialing rendering of context menu with predefined items.\n * @priority 9\n * @emits render\n * @emits unmount\n * @listens unmount\n * @listens contextmenu\n * @listens pointerdown\n */\nexport class ContextMenuPlugin<Schemes extends BaseSchemes> extends Scope<never, [Requires<Schemes> | ContextMenuExtra]> {\n  /**\n   * @param props Properties\n   */\n  constructor(private props: Props<Schemes>) {\n    super('context-menu')\n  }\n\n  setParent(scope: Scope<Requires<Schemes>>): void {\n    super.setParent(scope)\n\n    const area = this.parentScope<BaseAreaPlugin<Schemes, BaseArea<Schemes>>>(BaseAreaPlugin)\n    const container: HTMLElement = (area as any).container\n\n    if (!container || !(container instanceof HTMLElement)) throw new Error('container expected')\n\n    const element = document.createElement('div')\n\n    element.style.display = 'none'\n    element.style.position = 'fixed'\n\n    // eslint-disable-next-line max-statements\n    this.addPipe(context => {\n      const parent = this.parentScope()\n\n      if (!context || typeof context !== 'object' || !('type' in context)) return context\n      if (context.type === 'unmount') {\n        if (context.data.element === element) {\n          element.style.display = 'none'\n        }\n      } else if (context.type === 'contextmenu') {\n        context.data.event.preventDefault()\n        context.data.event.stopPropagation()\n\n        const { searchBar, list } = this.props.items(context.data.context, this)\n\n        container.appendChild(element)\n        element.style.left = `${context.data.event.clientX}px`\n        element.style.top = `${context.data.event.clientY}px`\n        element.style.display = ''\n\n        void parent.emit({\n          type: 'render',\n          data: {\n            type: 'contextmenu',\n            element,\n            searchBar,\n            onHide() {\n              void parent.emit({ type: 'unmount', data: { element } })\n            },\n            items: list\n          }\n        })\n      } else if (context.type === 'pointerdown') {\n        if (!context.data.event.composedPath().includes(element)) {\n          void parent.emit({ type: 'unmount', data: { element } })\n        }\n      }\n      return context\n    })\n  }\n}\n"],"names":["createItem","_ref","key","context","_ref2","_slicedToArray","label","factory","item","String","handler","_objectSpread","_asyncToGenerator","_regeneratorRuntime","mark","_callee","node","wrap","_callee$","_context","prev","next","sent","editor","addNode","area","translate","id","pointer","stop","subitems","map","data","i","setup","nodes","plugin","_context$clone","parentScope","BaseAreaPlugin","NodeEditor","searchBar","list","deleteItem","connectionId","nodeId","connections","_iterator","_step","connection","removeConnection","getConnections","filter","c","source","target","_createForOfIteratorHelper","s","n","done","value","t0","e","f","finish","removeNode","clone","bind","cloneItem","_callee2","_callee2$","_context2","concat","_toConsumableArray","ContextMenuPlugin","_Scope","props","_this","_classCallCheck","_callSuper","_inherits","_createClass","setParent","scope","_this2","_superPropGet","container","HTMLElement","Error","element","document","createElement","style","display","position","addPipe","parent","_typeof","type","event","preventDefault","stopPropagation","_this2$props$items","items","appendChild","left","clientX","top","clientY","emit","onHide","composedPath","includes","Scope"],"mappings":"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"}