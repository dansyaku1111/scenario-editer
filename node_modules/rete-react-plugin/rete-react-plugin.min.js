/*!
* rete-react-plugin v2.0.7
* (c) 2025 Vitaliy Stoliarov
* Released under the MIT license.
* */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react"),require("rete"),require("react-dom"),require("rete-render-utils"),require("styled-components"),require("rete-area-plugin")):"function"==typeof define&&define.amd?define(["exports","react","rete","react-dom","rete-render-utils","styled-components","rete-area-plugin"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).ReteReactPlugin={},t.React,t.Rete,t.ReactDOM,t.ReteRenderUtils,t.styled,t.ReteAreaPlugin)}(this,function(t,e,n,r,o,i,a){"use strict";function u(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}function c(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach(function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}}),e.default=t,Object.freeze(e)}var l=c(e),d=c(r),f=u(i);function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function p(t,e,n,r,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void n(t)}u.done?e(c):Promise.resolve(c).then(r,o)}function v(t,e,n){return e=w(e),function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,x()?Reflect.construct(e,n||[],w(t).constructor):e.apply(t,n))}function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,R(r.key),r)}}function b(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=D(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}function m(t,e,n){return(e=R(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h(){return h=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},h.apply(null,arguments)}function g(){return g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=w(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},g.apply(null,arguments)}function w(t){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},w(t)}function x(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(x=function(){return!!t})()}function O(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function E(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?O(Object(n),!0).forEach(function(e){m(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function k(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(-1!==e.indexOf(r))continue;n[r]=t[r]}return n}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],-1===e.indexOf(n)&&{}.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function j(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */
var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var c=r&&r.prototype instanceof u?r:u,l=Object.create(c.prototype);return P(l,"_invoke",function(n,r,o){var i,u,c,l=0,d=o||[],f=!1,s={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return i=e,u=0,c=t,s.n=n,a}};function p(n,r){for(u=n,c=r,e=0;!f&&l&&!o&&e<d.length;e++){var o,i=d[e],p=s.p,v=i[2];n>3?(o=v===r)&&(c=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=p&&((o=n<2&&p<i[1])?(u=0,s.v=r,s.n=i[1]):p<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,s.n=v,u=0))}if(o||n>1)return a;throw f=!0,r}return function(o,d,v){if(l>1)throw TypeError("Generator is already running");for(f&&1===d&&p(d,v),u=d,c=v;(e=u<2?t:c)||!f;){i||(u?u<3?(u>1&&(s.n=-1),p(u,c)):s.n=c:s.v=c);try{if(l=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(f=s.n<0)?c:n.call(r,s))!==a)break}catch(e){i=t,u=1,c=e}finally{l=1}}return{value:e,done:f}}}(n,o,i),!0),l}var a={};function u(){}function c(){}function l(){}e=Object.getPrototypeOf;var d=[][r]?e(e([][r]())):(P(e={},r,function(){return this}),e),f=l.prototype=u.prototype=Object.create(d);function s(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,P(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return c.prototype=l,P(f,"constructor",l),P(l,"constructor",c),c.displayName="GeneratorFunction",P(l,o,"GeneratorFunction"),P(f),P(f,o,"Generator"),P(f,r,function(){return this}),P(f,"toString",function(){return"[object Generator]"}),(j=function(){return{w:i,m:s}})()}function P(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}P=function(t,e,n,r){function i(e,n){P(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},P(t,e,n,r)}function S(t,e){return S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},S(t,e)}function _(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,u=[],c=!0,l=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(u.push(r.value),u.length!==e);c=!0);}catch(t){l=!0,o=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return u}}(t,e)||D(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function R(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}function C(t){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C(t)}function D(t,e){if(t){if("string"==typeof t)return s(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}function N(t){var n=t.children,r=t.rendered;return e.useEffect(function(){r()}),n}var M,T,A=e.createContext({start:null,end:null,path:null});function I(t){var n,o=t.children,i=_(e.useState(null),2),a=i[0],u=i[1],c=_(e.useState(null),2),d=c[0],f=c[1],s=_(e.useState(null),2),p=s[0],v=s[1],y="x"in t.start?t.start:a,b="x"in t.end?t.end:d,m=(n=e.useRef(!1),e.useEffect(function(){n.current=!0},[]),{apply:function(t){n.current?queueMicrotask(function(){r.flushSync(t)}):t()}});return e.useEffect(function(){var e="function"==typeof t.start&&t.start(function(t){m.apply(function(){u(t)})}),n="function"==typeof t.end&&t.end(function(t){m.apply(function(){f(t)})});return function(){e&&e(),n&&n()}},[]),e.useEffect(function(){y&&b&&t.path(y,b).then(function(t){m.apply(function(){v(t)})})},[y,b]),l.createElement(A.Provider,{value:{start:y,end:b,path:p}},o)}function B(){return e.useContext(A)}var L=f.default.svg(M||(M=z(["\n    overflow: visible !important;\n    position: absolute;\n    pointer-events: none;\n    width: 9999px;\n    height: 9999px;\n"]))),W=f.default.path(T||(T=z(["\n    fill: none;\n    stroke-width: 5px;\n    stroke: steelblue;\n    pointer-events: auto;\n    ","\n"])),function(t){var e;return null===(e=t.styles)||void 0===e?void 0:e.call(t,t)});function $(t){var e=B().path;return e?l.createElement(L,{"data-testid":"connection"},l.createElement(W,{styles:t.styles,d:e})):null}function q(t,e){return{start:function(n){var r=E({},e(n));function o(n){var o=E({},e(n)),i=o.x-r.x,a=o.y-r.y;r=o,t(i,a)}function i(){window.removeEventListener("pointermove",o),window.removeEventListener("pointerup",i),window.removeEventListener("pointercancel",i)}window.addEventListener("pointermove",o),window.addEventListener("pointerup",i),window.addEventListener("pointercancel",i)}}}function F(t,e){l.useEffect(function(){var n=function(t){if(!e){var n=function(t){for(var e=t;e;){if(e._reactRootContainer||Object.keys(e).some(function(t){return t.startsWith("__reactContainer$")}))return e;e=e.parentElement}}(t.target),r=l.version.startsWith("16")?document:n;r&&(t.stopPropagation(),r.dispatchEvent(function(t){for(var e=new t.constructor(t.type),n=e;n=Object.getPrototypeOf(n);){var r,o=b(Object.getOwnPropertyNames(n));try{for(o.s();!(r=o.n()).done;){var i=r.value;"function"!=typeof e[i]&&Object.defineProperty(e,i,{value:t[i]})}}catch(t){o.e(t)}finally{o.f()}}return e}(t)))}},r=t.current;return null==r||r.addEventListener("pointerdown",n),function(){null==r||r.removeEventListener("pointerdown",n)}},[t,e])}var G,H=Object.freeze({__proto__:null,useDrag:q,useNoDrag:F,NoDrag:function(t){var e=l.useRef(null);return F(e,t.disabled),l.createElement("span",{ref:e},t.children)}}),K=f.default.input(G||(G=z(["\n  width: 100%;\n  border-radius: 30px;\n  background-color: white;\n  padding: 2px 6px;\n  border: 1px solid #999;\n  font-size: 110%;\n  box-sizing: border-box;\n  ","\n"])),function(t){var e;return null===(e=t.styles)||void 0===e?void 0:e.call(t,t)});function U(t){var e=_(l.useState(t.data.value),2),n=e[0],r=e[1],o=l.useRef(null);return F(o),l.useEffect(function(){r(t.data.value)},[t.data.value]),l.createElement(K,{value:n,type:t.data.type,ref:o,readOnly:t.data.readonly,onChange:function(e){var n="number"===t.data.type?+e.target.value:e.target.value;r(n),t.data.setValue(n)},styles:t.styles})}var X="rgba(110,136,255,0.8)",Y="#ffd92c",V=24,J="#96b38a",Q=Object.freeze({__proto__:null,$nodecolor:X,$nodecolorselected:Y,$socketsize:V,$socketmargin:6,$socketcolor:J,$nodewidth:180}),Z=["init","unmount"];function tt(t){var e=t.init,n=t.unmount,r=k(t,Z),o=l.useRef(null);return l.useEffect(function(){var t=o.current;return function(){t&&n(t)}},[]),l.useEffect(function(){o.current&&e(o.current)}),l.createElement("span",h({},r,{ref:o}))}var et=["name","emit","payload"];function nt(t){var e=t.name,n=t.emit,r=t.payload,o=k(t,et);return l.createElement(tt,h({},o,{className:e,init:function(t){n({type:"render",data:{type:"control",element:t,payload:r}})},unmount:function(t){n({type:"unmount",data:{element:t}})}}))}var rt,ot,it=["name","emit","nodeId","side","socketKey","payload"];function at(t){var e=t.name,n=t.emit,r=t.nodeId,o=t.side,i=t.socketKey,a=t.payload,u=k(t,it);return l.createElement(tt,h({},u,{className:e,init:function(t){n({type:"render",data:{type:"socket",side:o,key:i,nodeId:r,element:t,payload:a}})},unmount:function(t){n({type:"unmount",data:{element:t}})}}))}var ut,ct,lt=f.default.div(rt||(rt=z(["\n    background: ",";\n    border: 2px solid #4e58bf;\n    border-radius: 10px;\n    cursor: pointer;\n    box-sizing: border-box;\n    width: ",";\n    height: ",";\n    padding-bottom: 6px;\n    position: relative;\n    user-select: none;\n    line-height: initial;\n    font-family: Arial;\n\n    &:hover {\n        background: lighten(",",4%);\n    }\n    ","\n    .title {\n        color: white;\n        font-family: sans-serif;\n        font-size: 18px;\n        padding: 8px;\n    }\n    .output {\n        text-align: right;\n    }\n    .input {\n        text-align: left;\n    }\n    .output-socket {\n        text-align: right;\n        margin-right: -","px;\n        display: inline-block;\n    }\n    .input-socket {\n        text-align: left;\n        margin-left: -","px;\n        display: inline-block;\n    }\n    .input-title,.output-title {\n        vertical-align: middle;\n        color: white;\n        display: inline-block;\n        font-family: sans-serif;\n        font-size: 14px;\n        margin: ","px;\n        line-height: ","px;\n    }\n    .input-control {\n        z-index: 1;\n        width: calc(100% - ","px);\n        vertical-align: middle;\n        display: inline-block;\n    }\n    .control {\n        display: block;\n        padding: ","px ","px;\n    }\n    ","\n"])),X,function(t){return Number.isFinite(t.width)?"".concat(t.width,"px"):"".concat(180,"px")},function(t){return Number.isFinite(t.height)?"".concat(t.height,"px"):"auto"},X,function(t){return t.selected&&i.css(ot||(ot=z(["\n        background: ",";\n        border-color: #e3c000;\n    "])),Y)},18,18,6,V,36,6,18,function(t){var e;return null===(e=t.styles)||void 0===e?void 0:e.call(t,t)});function dt(t){t.sort(function(t,e){var n,r;return((null===(n=t[1])||void 0===n?void 0:n.index)||0)-((null===(r=e[1])||void 0===r?void 0:r.index)||0)})}function ft(t){var e=Object.entries(t.data.inputs),n=Object.entries(t.data.outputs),r=Object.entries(t.data.controls),o=t.data.selected||!1,i=t.data,a=i.id,u=i.label,c=i.width,d=i.height;return dt(e),dt(n),dt(r),l.createElement(lt,{selected:o,width:c,height:d,styles:t.styles,"data-testid":"node"},l.createElement("div",{className:"title","data-testid":"title"},u),n.map(function(e){var n=_(e,2),r=n[0],o=n[1];return o&&l.createElement("div",{className:"output",key:r,"data-testid":"output-".concat(r)},l.createElement("div",{className:"output-title","data-testid":"output-title"},o.label),l.createElement(at,{name:"output-socket",side:"output",socketKey:r,nodeId:a,emit:t.emit,payload:o.socket,"data-testid":"output-socket"}))}),r.map(function(e){var n=_(e,2),r=n[0],o=n[1];return o?l.createElement(nt,{key:r,name:"control",emit:t.emit,payload:o,"data-testid":"control-".concat(r)}):null}),e.map(function(e){var n=_(e,2),r=n[0],o=n[1];return o&&l.createElement("div",{className:"input",key:r,"data-testid":"input-".concat(r)},l.createElement(at,{name:"input-socket",side:"input",socketKey:r,nodeId:a,emit:t.emit,payload:o.socket,"data-testid":"input-socket"}),o&&(!o.control||!o.showControl)&&l.createElement("div",{className:"input-title","data-testid":"input-title"},o.label),o.control&&o.showControl&&l.createElement(nt,{key:r,name:"input-control",emit:t.emit,payload:o.control,"data-testid":"input-control"}))}))}var st=f.default.div(ut||(ut=z(["\n    display: inline-block;\n    cursor: pointer;\n    border: 1px solid white;\n    border-radius: ","px;\n    width: ","px;\n    height: ","px;\n    vertical-align: middle;\n    background: ",";\n    z-index: 2;\n    box-sizing: border-box;\n    &:hover {\n      border-width: 4px;\n    }\n    &.multiple {\n      border-color: yellow;\n    }\n"])),12,V,V,J),pt=f.default.div(ct||(ct=z(["\n    border-radius: ","px;\n    padding: ","px;\n    &:hover "," {\n      border-width: 4px;\n    }\n"])),18,6,st);function vt(t){return l.createElement(pt,null,l.createElement(st,{title:t.data.name}))}var yt=Object.freeze({__proto__:null,vars:Q,setup:function(t){var e=void 0===(null==t?void 0:t.socketPositionWatcher)?o.getDOMSocketPosition():t.socketPositionWatcher,r=(null==t?void 0:t.customize)||{},i=r.node,a=r.connection,u=r.socket,c=r.control;return{attach:function(t){e.attach(t)},render:function(t,r){if("node"===t.data.type){var d=r.parentScope(),f=i?i(t.data):ft;return f&&l.createElement(f,{data:t.data.payload,emit:function(t){d.emit(t)}})}if("connection"===t.data.type){var s=a?a(t.data):$,v=t.data.payload,y=v.sourceOutput,b=v.targetInput,m=v.source,h=v.target;return s&&l.createElement(I,{start:t.data.start||function(t){return e.listen(m,"output",y,t)},end:t.data.end||function(t){return e.listen(h,"input",b,t)},path:function(){var t,e=(t=j().m(function t(e,n){var i,a,u,c,l;return j().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,r.emit({type:"connectionpath",data:{payload:v,points:[e,n]}});case 1:if(i=t.v){t.n=2;break}return t.a(2,"");case 2:if(a=i.data,u=a.path,c=a.points,l=.3,u||2===c.length){t.n=3;break}throw new Error("cannot render connection with a custom number of points");case 3:if(u){t.n=4;break}return t.a(2,v.isLoop?o.loopConnectionPath(c,l,120):o.classicConnectionPath(c,l));case 4:return t.a(2,u)}},t)}),function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(t){p(i,r,o,a,u,"next",t)}function u(t){p(i,r,o,a,u,"throw",t)}a(void 0)})});return function(t,n){return e.apply(this,arguments)}}()},l.createElement(s,{data:t.data.payload}))}if("socket"===t.data.type){var g=u?u(t.data):vt;return g&&t.data.payload&&l.createElement(g,{data:t.data.payload})}if("control"===t.data.type){var w=c&&t.data.payload?c(t.data):t.data.payload instanceof n.ClassicPreset.InputControl?U:null;return w&&l.createElement(w,{data:t.data.payload})}}}},Connection:$,useConnection:B,Control:U,InputControl:U,Node:ft,NodeStyles:lt,RefControl:nt,RefSocket:at,Socket:vt});function bt(t,n){var r=e.useRef(void 0);function o(){r.current&&clearTimeout(r.current)}return e.useEffect(function(){return o},[]),[function(){o(),r.current=setTimeout(function(){t()},n)},o]}var mt,ht,gt,wt,xt,Ot="5px",Et=f.default.div(mt||(mt=z(["\n  color: #fff;\n  padding: 4px;\n  border-bottom: 1px solid ",";\n  background-color: ",";\n  cursor: pointer;\n  width: 100%;\n  position: relative;\n  &:first-child {\n    border-top-left-radius: ",";\n    border-top-right-radius: ",";\n  }\n  &:last-child {\n    border-bottom-left-radius: ",";\n    border-bottom-right-radius: ",";\n  }\n  &:hover {\n    background-color: ",";\n  }\n"])),"rgba(69, 103, 255, 0.8)","rgba(110,136,255,0.8)",Ot,Ot,Ot,Ot,"rgba(130, 153, 255, 0.8)"),kt=f.default(Et)(ht||(ht=z(["\n    ","\n"])),function(t){return t.hasSubitems&&i.css(gt||(gt=z(["&:after {\n    content: '►';\n    position: absolute;\n    opacity: 0.6;\n    right: 5px;\n    top: 5px;\n    }"])))}),jt=f.default.div(wt||(wt=z(["\n    position: absolute;\n    top: 0;\n    left: 100%;\n    width: ","px;\n"])),120);function Pt(t){var e,n,r,o,i=_(l.useState(!1),2),a=i[0],u=i[1],c=_(bt(l.useCallback(function(){u(!1)},[u]),t.delay),2),d=c[0],f=c[1],s=(null===(e=t.components)||void 0===e||null===(n=e.item)||void 0===n?void 0:n.call(e,t.data))||kt,p=(null===(r=t.components)||void 0===r||null===(o=r.subitems)||void 0===o?void 0:o.call(r,t.data))||jt;return l.createElement(s,{onClick:function(e){e.stopPropagation(),t.data.handler(),t.hide()},hasSubitems:Boolean(t.data.subitems),onPointerDown:function(t){t.stopPropagation()},onPointerOver:function(){f(),u(!0)},onPointerLeave:function(){d&&d()},"data-testid":"context-menu-item"},t.children,t.data.subitems&&a&&l.createElement(p,null,t.data.subitems.map(function(e){return l.createElement(Pt,{key:e.key,data:e,delay:t.delay,hide:t.hide,components:t.components},e.label)})))}var St,_t=f.default.input(xt||(xt=z(["\n  color: white;\n  padding: 1px 8px;\n  border: 1px solid white;\n  border-radius: 10px;\n  font-size: 16px;\n  font-family: serif;\n  width: 100%;\n  box-sizing: border-box;\n  background: transparent;\n"])));function zt(t){var e=t.component||_t;return l.createElement(e,{value:t.value,onInput:function(e){t.onChange(e.target.value)},onPointerDown:function(t){t.stopPropagation()},"data-testid":"context-menu-search-input"})}var Rt=f.default.div(St||(St=z(["\n  padding: 10px;\n  width: ","px;\n  margin-top: -20px;\n  margin-left: -","px;\n"])),120,60);function Ct(t){var e,n,r,o,i,a,u=_(bt(t.onHide,t.delay),2),c=u[0],d=u[1],f=_(l.useState(""),2),s=f[0],p=f[1],v=new RegExp(s,"i"),y=t.items.filter(function(t){return t.label.match(v)}),b=(null===(e=t.components)||void 0===e||null===(n=e.main)||void 0===n?void 0:n.call(e))||Rt,m=(null===(r=t.components)||void 0===r||null===(o=r.common)||void 0===o?void 0:o.call(r))||Et;return l.createElement(b,{onMouseOver:function(){d()},onMouseLeave:function(){null==c||c()},onWheel:function(t){t.stopPropagation()},"data-testid":"context-menu"},t.searchBar&&l.createElement(m,null,l.createElement(zt,{value:s,onChange:p,component:null===(i=t.components)||void 0===i||null===(a=i.search)||void 0===a?void 0:a.call(i)})),y.map(function(e){return l.createElement(Pt,{key:e.key,data:e,delay:t.delay,hide:t.onHide,components:t.components},e.label)}))}var Dt=Object.freeze({__proto__:null,setup:function(t){var e=void 0===(null==t?void 0:t.delay)?1e3:t.delay;return{render:function(n){if("contextmenu"===n.data.type)return l.createElement(Ct,{items:n.data.items,delay:e,searchBar:n.data.searchBar,onHide:n.data.onHide,components:null==t?void 0:t.customize})}}},Item:kt,Subitems:jt,Menu:Rt,Search:_t,Common:Et}),Nt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Mt="object"==typeof Nt&&Nt&&Nt.Object===Object&&Nt,Tt="object"==typeof self&&self&&self.Object===Object&&self;Mt||Tt||Function("return this")();var At,It={width:void 0,height:void 0};function Bt(t){const{ref:n,box:r="content-box"}=t,[{width:o,height:i},a]=e.useState(It),u=function(){const t=e.useRef(!1);return e.useEffect(()=>(t.current=!0,()=>{t.current=!1}),[]),e.useCallback(()=>t.current,[])}(),c=e.useRef({...It}),l=e.useRef(void 0);return l.current=t.onResize,e.useEffect(()=>{if(!n.current)return;if("undefined"==typeof window||!("ResizeObserver"in window))return;const t=new ResizeObserver(([t])=>{const e="border-box"===r?"borderBoxSize":"device-pixel-content-box"===r?"devicePixelContentBoxSize":"contentBoxSize",n=Lt(t,e,"inlineSize"),o=Lt(t,e,"blockSize");if(c.current.width!==n||c.current.height!==o){const t={width:n,height:o};c.current.width=n,c.current.height=o,l.current?l.current(t):u()&&a(t)}});return t.observe(n.current,{box:r}),()=>{t.disconnect()}},[r,n,u]),{width:o,height:i}}function Lt(t,e,n){return t[e]?Array.isArray(t[e])?t[e][0][n]:t[e][n]:"contentBoxSize"===e?t.contentRect["inlineSize"===n?"width":"height"]:void 0}function Wt(t){return"".concat(t,"px")}var $t,qt=f.default.div(At||(At=z(["\n    position: absolute;\n    background: rgba(110, 136, 255, 0.8);\n    border: 1px solid rgb(192 206 212 / 60%);\n"])));function Ft(t){return l.createElement(qt,{style:{left:Wt(t.left),top:Wt(t.top),width:Wt(t.width),height:Wt(t.height)},"data-testid":"minimap-node"})}var Gt,Ht=f.default.div($t||($t=z(["\n  position: absolute;\n  background: rgba(255, 251, 128, 0.32);\n  border: 1px solid #ffe52b;\n"])));function Kt(t){var e=function(e){return e*t.containerWidth},n=function(e){return e/t.containerWidth},r=q(function(e,r){t.translate(n(-e),n(-r))},function(t){return{x:t.pageX,y:t.pageY}});return l.createElement(Ht,{onPointerDown:r.start,style:{left:Wt(e(t.left)),top:Wt(e(t.top)),width:Wt(e(t.width)),height:Wt(e(t.height))},"data-testid":"minimap-viewport"})}var Ut=f.default.div(Gt||(Gt=z(["\n    position: absolute;\n    right: 24px;\n    bottom: 24px;\n    background: rgba(229, 234, 239, 0.65);\n    padding: 20px;\n    overflow: hidden;\n    border: 1px solid #b1b7ff;\n    border-radius: 8px;\n    box-sizing: border-box;\n"])));function Xt(t){var n,r=e.useRef(null),o=Bt({ref:r}).width,i=void 0===o?0:o,a=(null===(n=r.current)||void 0===n?void 0:n.clientWidth)||i,u=e.useCallback(function(t){return t*a},[a]);return l.createElement(Ut,{size:t.size,style:{width:Wt(t.size*t.ratio),height:Wt(t.size)},onPointerDown:function(t){t.stopPropagation(),t.preventDefault()},onDoubleClick:function(e){if(e.stopPropagation(),e.preventDefault(),r.current){var n=r.current.getBoundingClientRect(),o=(e.clientX-n.left)/(t.size*t.ratio),i=(e.clientY-n.top)/(t.size*t.ratio);t.point(o,i)}},ref:r,"data-testid":"minimap"},a?t.nodes.map(function(t,e){return l.createElement(Ft,{key:e,left:u(t.left),top:u(t.top),width:u(t.width),height:u(t.height)})}):null,l.createElement(Kt,h({},t.viewport,{start:t.start,containerWidth:a,translate:t.translate})))}var Yt,Vt=Object.freeze({__proto__:null,setup:function(t){return{render:function(e){if("minimap"===e.data.type)return l.createElement(Xt,{nodes:e.data.nodes,size:(null==t?void 0:t.size)||200,ratio:e.data.ratio,viewport:e.data.viewport,start:e.data.start,translate:e.data.translate,point:e.data.point})}}}}),Jt=f.default.div(Yt||(Yt=z(["\n  width: ","px;\n  height: ","px;\n  box-sizing: border-box;\n  background: ",";\n  border: 2px solid white;\n  border-radius: ","px;\n"])),20,20,function(t){return t.selected?"#ffd92c":"steelblue"},20);function Qt(t){var e=q(function(e,n){t.translate(e,n)},t.pointer),n=t.position,r=n.x,o=n.y;return l.createElement(Jt,{onPointerDown:function(n){n.stopPropagation(),n.preventDefault(),e.start(n),t.pointerdown()},onContextMenu:function(e){e.stopPropagation(),e.preventDefault(),t.contextMenu()},selected:t.selected,style:{position:"absolute",top:"".concat(o-10,"px"),left:"".concat(r-10,"px")},"data-testid":"pin"})}var Zt=Object.freeze({__proto__:null,setup:function(t){return{render:function(e,n){var r=e.data,o=n.parentScope(a.BaseAreaPlugin);if("reroute-pins"===r.type)return function(e,n){return l.createElement(l.Fragment,null,e.pins.map(function(e){return l.createElement(Qt,h({},e,{key:e.id,contextMenu:function(){var n;null==t||null===(n=t.contextMenu)||void 0===n||n.call(t,e.id)},translate:function(n,r){var o;null==t||null===(o=t.translate)||void 0===o||o.call(t,e.id,n,r)},pointerdown:function(){var n;null==t||null===(n=t.pointerdown)||void 0===n||n.call(t,e.id)},pointer:n}))}))}(r.data,function(){return o.area.pointer})}}}}),te=Object.freeze({__proto__:null,classic:yt,contextMenu:Dt,minimap:Vt,reroute:Zt}),ee=function(t){function e(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];var i=r[0];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),m(t=v(this,e,["react-render"]),"presets",[]),t.renderer=function(t){var e=null==t?void 0:t.createRoot,n=new WeakMap;function r(t){var e=n.get(t);if(e)return e;var r=document.createElement("span");return t.appendChild(r),n.set(t,r),r}function o(t){var e=n.get(t);e&&(e.remove(),n.delete(t))}if(e){var i=new WeakMap;return{mount:function(t,n){var o,a=r(n),u=i.get(a);return u||(u=e(a),i.set(a,u)),u.render(t),null!==(o=a.firstElementChild)&&void 0!==o?o:a},unmount:function(t){var e=r(t),n=i.get(e);n&&(n.unmount(),i.delete(e)),o(t)}}}return{mount:function(t,e){var n=r(e);if("render"in d&&"function"==typeof d.render)return d.render(t,n)||n;throw new Error("ReactDOM.render is not available")},unmount:function(t){var e=r(t);if(!("unmountComponentAtNode"in d)||"function"!=typeof d.unmountComponentAtNode)throw new Error("ReactDOM.unmountComponentAtNode is not available");d.unmountComponentAtNode(e),o(t)}}}({createRoot:null==i?void 0:i.createRoot}),t.addPipe(function(e){if(!e||"object"!==C(e)||!("type"in e))return e;if("unmount"===e.type)t.unmount(e.data.element);else if("render"===e.type){if("filled"in e.data&&e.data.filled)return e;if(t.mount(e.data.element,e))return E(E({},e),{},{data:E(E({},e.data),{},{filled:!0})})}return e}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&S(t,e)}(e,t),n=e,r=[{key:"setParent",value:function(t){var n,r,o,i,a,u=this;(n=e,r="setParent",o=this,a=g(w(1&(i=3)?n.prototype:n),r,o),2&i&&"function"==typeof a?function(t){return a.apply(o,t)}:a)([t]),this.presets.forEach(function(t){t.attach&&t.attach(u)})}},{key:"mount",value:function(t,e){var n,r=this.parentScope(),o=b(this.presets);try{for(o.s();!(n=o.n()).done;){var i=n.value.render(e,this);if(i){var a=l.createElement(N,{rendered:function(){r.emit({type:"rendered",data:e.data})}},i);return this.renderer.mount(a,t),!0}}}catch(t){o.e(t)}finally{o.f()}}},{key:"unmount",value:function(t){this.renderer.unmount(t)}},{key:"addPreset",value:function(t){var e=t;e.attach&&e.attach(this),this.presets.push(e)}}],r&&y(n.prototype,r),o&&y(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o}(n.Scope);t.Drag=H,t.Presets=te,t.ReactPlugin=ee,t.RefComponent=tt,t.useRete=function(t){var n=_(e.useState(null),2),r=n[0],o=n[1],i=e.useRef(void 0),a=_(e.useState(null),2),u=a[0],c=a[1],l=e.useRef(null);return e.useEffect(function(){r&&(i.current&&(i.current.destroy(),r.innerHTML=""),t(r).then(function(t){i.current=t,c(t)}))},[r,t]),e.useEffect(function(){return function(){i.current&&i.current.destroy()}},[]),e.useEffect(function(){l.current&&o(l.current)},[l.current]),[l,u]},Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=rete-react-plugin.min.js.map
